class Contacts{get options(){return{emptyThumb:Helpers.UrlFix("img/profile/profile-11.jpg")}}constructor(e={}){this.settings=Object.assign(this.options,e),this.contactModal=new bootstrap.Modal(document.getElementById("contactModal")),this.deleteConfirmModal=new bootstrap.Modal(document.getElementById("deleteConfirmModal")),Helpers.FetchJSON(Helpers.UrlFix("json/contacts.json"),(e=>{this.contacts=e.map((e=>({...e,thumb:Helpers.UrlFix(e.thumb)}))),this._init()}))}_init(){this.contactContainer=document.querySelector("#contacts .list"),this.currentItem=null,this.listjs=null,this.deletingMultiple=!1,this._addListeners(),this._initListjs(),this._initProfileUpload(),this._initGroupSelect(),this._initCheckAll()}_addListeners(){this.contactContainer.addEventListener("click",this._onContainerClick.bind(this)),document.getElementById("newContactButton")&&document.getElementById("newContactButton").addEventListener("click",this._showAddModal.bind(this)),document.getElementById("deleteContact")&&document.getElementById("deleteContact").addEventListener("click",this._deleteContact.bind(this)),document.getElementById("addContact")&&document.getElementById("addContact").addEventListener("click",this._addContact.bind(this)),document.getElementById("saveContact")&&document.getElementById("saveContact").addEventListener("click",this._saveContact.bind(this)),document.getElementById("deleteConfirmButton")&&document.getElementById("deleteConfirmButton").addEventListener("click",this._deleteContactConfirm.bind(this)),document.getElementById("deleteChecked")&&document.getElementById("deleteChecked").addEventListener("click",this._deleteChecked.bind(this))}_initGroupSelect(){jQuery().select2&&jQuery("#contactGroupModal").select2({minimumResultsForSearch:1/0})}_initCheckAll(){new Checkall(document.querySelector(".check-all-container-checkbox-click .btn-custom-control"),{clickSelector:".form-check"})}_initListjs(){this.listjs=new List(document.querySelector("#contacts"),{valueNames:["id","name","email","phone","group","position",{name:"thumb",attr:"src"}],item:"contactItemTemplate",page:8,pagination:[{includeDirectionLinks:!0,leftDirectionText:'<i class="cs-chevron-left"></i>',rightDirectionText:'<i class="cs-chevron-right"></i>',liClass:"page-item",aClass:"page-link shadow",innerWindow:1e3}]},this.contacts),this.listjs.sort("id",{order:"desc"}),this.listjs.on("updated",(function(e){}))}_onContainerClick(e){if(!e.target.closest(".view-click"))return;e.preventDefault();const t=e.target.closest(".card").querySelector(".id").innerHTML;this.currentItem=this.listjs.get("id",t)[0],this._showDetailModal()}_showAddModal(e){this._clearAddEditModal(),this._enableAdd(),this.contactModal.show()}_showDetailModal(){document.getElementById("contactNameModal").value=this.currentItem.values().name,document.getElementById("contactPositionModal").value=this.currentItem.values().position,document.getElementById("contactEmailModal").value=this.currentItem.values().email,document.getElementById("contactPhoneModal").value=this.currentItem.values().phone,document.getElementById("contactGroupModal").value=this.currentItem.values().group,document.getElementById("contactThumbModal").setAttribute("src",this.currentItem.values().thumb),jQuery("#contactGroupModal").trigger("change"),this.contactModal.show(),this._enableEdit()}_saveContact(){const e=this.currentItem.values().id,t=this._getCurrentDataFromModal(e);this.currentItem.values(t),this.contactModal.hide()}_addContact(){const e=this.listjs.items.map((e=>e.values())),t=Helpers.NextId(e,"id"),n=this._getCurrentDataFromModal(t);this.listjs.add(n),this.contactModal.hide(),this.listjs.sort("id",{order:"desc"})}_deleteContact(e){this.deletingMultiple=!1,document.getElementById("deleteConfirmDetail").innerHTML=this.currentItem.values().name,this.deleteConfirmModal.show()}_deleteChecked(e){this.deletingMultiple=!0;const t=document.querySelectorAll(".list .card.selected");t.length>0&&(document.getElementById("deleteConfirmDetail").innerHTML=t.length+" item"+(t.length>1?"s":""),this.deleteConfirmModal.show())}_deleteContactConfirm(e){if(this.deletingMultiple){document.querySelectorAll(".list .card.selected").forEach((e=>{this.listjs.remove("id",e.querySelector(".id").innerHTML)}))}else{const e=this.currentItem.values().id;this.listjs.remove("id",e)}this.contactModal.hide(),this.deleteConfirmModal.hide();const t=document.querySelector(".check-all-container-checkbox-click .btn-custom-control input");t.indeterminate=!1,t.checked=!1}_getCurrentDataFromModal(e){return{name:document.getElementById("contactNameModal").value,position:document.getElementById("contactPositionModal").value,email:document.getElementById("contactEmailModal").value,phone:document.getElementById("contactPhoneModal").value,group:document.getElementById("contactGroupModal").value,thumb:document.getElementById("contactThumbModal").getAttribute("src"),id:e}}_initProfileUpload(){if("undefined"!=typeof SingleImageUpload){new SingleImageUpload(document.getElementById("imageUpload"),{fileSelectCallback:e=>{console.log(e)}})}}_clearAddEditModal(){document.getElementById("contactNameModal").value="",document.getElementById("contactPositionModal").value="",document.getElementById("contactEmailModal").value="",document.getElementById("contactPhoneModal").value="",document.getElementById("contactGroupModal").value=null,document.getElementById("contactThumbInputModal").value=null,document.getElementById("contactThumbModal").setAttribute("src",this.settings.emptyThumb),jQuery("#contactGroupModal").trigger("change")}_enableEdit(){this._showElement("saveContact"),this._showElement("deleteContact"),this._hideElement("addContact")}_enableAdd(){this._hideElement("saveContact"),this._hideElement("deleteContact"),this._showElement("addContact")}_showElement(e){document.getElementById(e)&&document.getElementById(e).classList.add("d-inline-block"),document.getElementById(e)&&document.getElementById(e).classList.remove("d-none")}_hideElement(e){document.getElementById(e)&&document.getElementById(e).classList.remove("d-inline-block"),document.getElementById(e)&&document.getElementById(e).classList.add("d-none")}}